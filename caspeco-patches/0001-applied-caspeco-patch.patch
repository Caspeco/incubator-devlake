From dd80dc8c79b29b79fdfe3922db762e9e1f9a43f9 Mon Sep 17 00:00:00 2001
From: Lukasz Borawski <lukasz.borawski@trivec.be>
Date: Fri, 9 Jan 2026 10:21:29 +0100
Subject: [PATCH] Applied Caspeco Patch

---
 backend/plugins/github/models/deployment.go   |  41 +--
 ...latest_status_update_date_to_deployment.go |  54 ++++
 .../models/migrationscripts/register.go       |   1 +
 .../tasks/deployment_collector.go             |   7 +
 .../tasks/deployment_convertor.go             |   6 +-
 .../tasks/deployment_extractor.go             |  48 ++--
 caspeco.patch                                 | 236 ++++++++++++++++++
 7 files changed, 352 insertions(+), 41 deletions(-)
 create mode 100644 backend/plugins/github/models/migrationscripts/20251217_add_latest_status_update_date_to_deployment.go
 create mode 100644 caspeco.patch

diff --git a/backend/plugins/github/models/deployment.go b/backend/plugins/github/models/deployment.go
index 6a818be45..a41c08cf8 100644
--- a/backend/plugins/github/models/deployment.go
+++ b/backend/plugins/github/models/deployment.go
@@ -24,26 +24,27 @@ import (
 )
 
 type GithubDeployment struct {
-	common.NoPKModel  `json:"-" mapstructure:"-"`
-	ConnectionId      uint64 `json:"connection_id" gorm:"primaryKey"`
-	GithubId          int    `json:"github_id"`
-	Id                string `json:"id" gorm:"type:varchar(255);primaryKey"`
-	DisplayTitle      string
-	Url               string
-	DatabaseId        uint       `json:"database_id"`
-	CommitOid         string     `json:"commit_oid" gorm:"type:varchar(255)"`
-	Description       string     `json:"description" gorm:"type:varchar(255)"`
-	Environment       string     `json:"environment" gorm:"type:varchar(255)"`
-	State             string     `json:"state" gorm:"type:varchar(255)"`
-	LatestStatusState string     `json:"latest_status_state" gorm:"type:varchar(255)"`
-	LatestUpdatedDate *time.Time `json:"latest_status_update_date"`
-	RepositoryID      string     `json:"repository_id" gorm:"type:varchar(255)"`
-	RepositoryName    string     `json:"repository_name" gorm:"type:varchar(255)"`
-	RepositoryUrl     string     `json:"repository_url" gorm:"type:varchar(255)"`
-	RefName           string     `json:"ref_name" gorm:"type:varchar(255)"`
-	Payload           string     `json:"payload" gorm:"type:text"`
-	CreatedDate       time.Time  `json:"created_at"`
-	UpdatedDate       time.Time  `json:"updated_at"`
+	common.NoPKModel         `json:"-" mapstructure:"-"`
+	ConnectionId             uint64 `json:"connection_id" gorm:"primaryKey"`
+	GithubId                 int    `json:"github_id"`
+	Id                       string `json:"id" gorm:"type:varchar(255);primaryKey"`
+	DisplayTitle             string
+	Url                      string
+	DatabaseId               uint       `json:"database_id"`
+	CommitOid                string     `json:"commit_oid" gorm:"type:varchar(255)"`
+	Description              string     `json:"description" gorm:"type:varchar(255)"`
+	Environment              string     `json:"environment" gorm:"type:varchar(255)"`
+	State                    string     `json:"state" gorm:"type:varchar(255)"`
+	LatestStatusState        string     `json:"latest_status_state" gorm:"type:varchar(255)"`
+	LatestUpdatedDate        *time.Time `json:"latest_status_update_date"`
+	LatestSuccessUpdatedDate *time.Time `json:"latest_success_updated_date"`
+	RepositoryID             string     `json:"repository_id" gorm:"type:varchar(255)"`
+	RepositoryName           string     `json:"repository_name" gorm:"type:varchar(255)"`
+	RepositoryUrl            string     `json:"repository_url" gorm:"type:varchar(255)"`
+	RefName                  string     `json:"ref_name" gorm:"type:varchar(255)"`
+	Payload                  string     `json:"payload" gorm:"type:text"`
+	CreatedDate              time.Time  `json:"created_at"`
+	UpdatedDate              time.Time  `json:"updated_at"`
 }
 
 func (GithubDeployment) TableName() string {
diff --git a/backend/plugins/github/models/migrationscripts/20251217_add_latest_status_update_date_to_deployment.go b/backend/plugins/github/models/migrationscripts/20251217_add_latest_status_update_date_to_deployment.go
new file mode 100644
index 000000000..334a3918d
--- /dev/null
+++ b/backend/plugins/github/models/migrationscripts/20251217_add_latest_status_update_date_to_deployment.go
@@ -0,0 +1,54 @@
+/*
+Licensed to the Apache Software Foundation (ASF) under one or more
+contributor license agreements.  See the NOTICE file distributed with
+this work for additional information regarding copyright ownership.
+The ASF licenses this file to You under the Apache License, Version 2.0
+(the "License"); you may not use this file except in compliance with
+the License.  You may obtain a copy of the License at
+
+    http://www.apache.org/licenses/LICENSE-2.0
+
+Unless required by applicable law or agreed to in writing, software
+distributed under the License is distributed on an "AS IS" BASIS,
+WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+See the License for the specific language governing permissions and
+limitations under the License.
+*/
+
+package migrationscripts
+
+import (
+	"time"
+
+	"github.com/apache/incubator-devlake/core/context"
+	"github.com/apache/incubator-devlake/core/errors"
+	"github.com/apache/incubator-devlake/core/plugin"
+)
+
+var _ plugin.MigrationScript = (*addLatestStatusUpdateDateToDeployment)(nil)
+
+type deployment20251217 struct {
+	LatestSuccessUpdatedDate time.Time `json:"latest_success_updated_date"`
+}
+
+func (deployment20251217) TableName() string {
+	return "_tool_github_deployments"
+}
+
+type addLatestStatusUpdateDateToDeployment struct{}
+
+func (*addLatestStatusUpdateDateToDeployment) Up(basicRes context.BasicRes) errors.Error {
+	db := basicRes.GetDal()
+	if err := db.AutoMigrate(&deployment20251217{}); err != nil {
+		return err
+	}
+	return nil
+}
+
+func (*addLatestStatusUpdateDateToDeployment) Version() uint64 {
+	return 20251217000000
+}
+
+func (*addLatestStatusUpdateDateToDeployment) Name() string {
+	return "add latest_success_updated_date to _tool_github_deployments"
+}
\ No newline at end of file
diff --git a/backend/plugins/github/models/migrationscripts/register.go b/backend/plugins/github/models/migrationscripts/register.go
index b8a0722eb..bf4635699 100644
--- a/backend/plugins/github/models/migrationscripts/register.go
+++ b/backend/plugins/github/models/migrationscripts/register.go
@@ -55,5 +55,6 @@ func All() []plugin.MigrationScript {
 		new(addIsDraftToPr),
 		new(changeIssueComponentType),
 		new(addIndexToGithubJobs),
+		new(addLatestStatusUpdateDateToDeployment),
 	}
 }
diff --git a/backend/plugins/github_graphql/tasks/deployment_collector.go b/backend/plugins/github_graphql/tasks/deployment_collector.go
index b28c8deca..2477f1b71 100644
--- a/backend/plugins/github_graphql/tasks/deployment_collector.go
+++ b/backend/plugins/github_graphql/tasks/deployment_collector.go
@@ -91,6 +91,13 @@ type GraphqlQueryDeploymentDeployment struct {
 		} `graphql:"author"`
 		CommittedDate time.Time `graphql:"committedDate"`
 	} `graphql:"commit"`
+	Statuses struct {
+		Nodes []struct {
+			CreatedAt time.Time `graphql:"createdAt"`
+			UpdatedAt time.Time `graphql:"updatedAt"`
+			State     string    `graphql:"state"`
+		} `graphql:"nodes"`
+	} `graphql:"statuses(first: 10)"`
 }
 
 // CollectDeployments will request github api via graphql and store the result into raw layer.
diff --git a/backend/plugins/github_graphql/tasks/deployment_convertor.go b/backend/plugins/github_graphql/tasks/deployment_convertor.go
index fdc439553..ec07c2bb3 100644
--- a/backend/plugins/github_graphql/tasks/deployment_convertor.go
+++ b/backend/plugins/github_graphql/tasks/deployment_convertor.go
@@ -19,6 +19,7 @@ package tasks
 
 import (
 	"reflect"
+	"regexp"
 
 	"github.com/apache/incubator-devlake/core/dal"
 	"github.com/apache/incubator-devlake/core/errors"
@@ -90,7 +91,7 @@ func ConvertDeployment(taskCtx plugin.SubTaskContext) errors.Error {
 				TaskDatesInfo: devops.TaskDatesInfo{
 					CreatedDate:  githubDeployment.CreatedDate,
 					StartedDate:  &githubDeployment.CreatedDate,
-					FinishedDate: &githubDeployment.UpdatedDate,
+					FinishedDate: githubDeployment.LatestSuccessUpdatedDate,
 				},
 				CommitSha:    githubDeployment.CommitOid,
 				RefName:      githubDeployment.RefName,
@@ -103,8 +104,9 @@ func ConvertDeployment(taskCtx plugin.SubTaskContext) errors.Error {
 			durationSec := float64(githubDeployment.UpdatedDate.Sub(githubDeployment.CreatedDate).Milliseconds() / 1e3)
 			deploymentCommit.DurationSec = &durationSec
 
+			versionPattern := regexp.MustCompile(`^\d+\.\d+`)
 			if data.RegexEnricher != nil {
-				if data.RegexEnricher.ReturnNameIfMatched(devops.ENV_NAME_PATTERN, githubDeployment.Environment) != "" {
+				if data.RegexEnricher.ReturnNameIfMatched(devops.ENV_NAME_PATTERN, githubDeployment.Environment) != "" && versionPattern.MatchString(githubDeployment.RefName) {
 					deploymentCommit.Environment = devops.PRODUCTION
 				}
 			}
diff --git a/backend/plugins/github_graphql/tasks/deployment_extractor.go b/backend/plugins/github_graphql/tasks/deployment_extractor.go
index 78a96ca76..6343451b5 100644
--- a/backend/plugins/github_graphql/tasks/deployment_extractor.go
+++ b/backend/plugins/github_graphql/tasks/deployment_extractor.go
@@ -75,28 +75,38 @@ func ExtractDeployments(taskCtx plugin.SubTaskContext) errors.Error {
 
 func convertGithubDeployment(deployment *GraphqlQueryDeploymentDeployment, connectionId uint64, githubId int) (*githubModels.GithubDeployment, errors.Error) {
 	ret := &githubModels.GithubDeployment{
-		ConnectionId:      connectionId,
-		GithubId:          githubId,
-		NoPKModel:         common.NewNoPKModel(),
-		Id:                deployment.Id,
-		DisplayTitle:      strings.Split(deployment.Commit.Message, "\n")[0],
-		Url:               deployment.Repository.Url + "/deployments/" + deployment.Environment,
-		DatabaseId:        deployment.DatabaseId,
-		Payload:           deployment.Payload,
-		Description:       deployment.Description,
-		CommitOid:         deployment.CommitOid,
-		Environment:       deployment.Environment,
-		State:             deployment.State,
-		RepositoryID:      deployment.Repository.Id,
-		RepositoryName:    deployment.Repository.Name,
-		RepositoryUrl:     deployment.Repository.Url,
-		CreatedDate:       deployment.CreatedAt,
-		UpdatedDate:       deployment.UpdatedAt,
-		LatestStatusState: deployment.LatestStatus.State,
-		LatestUpdatedDate: deployment.LatestStatus.UpdatedAt,
+		ConnectionId:             connectionId,
+		GithubId:                 githubId,
+		NoPKModel:                common.NewNoPKModel(),
+		Id:                       deployment.Id,
+		DisplayTitle:             strings.Split(deployment.Commit.Message, "\n")[0],
+		Url:                      deployment.Repository.Url + "/deployments/" + deployment.Environment,
+		DatabaseId:               deployment.DatabaseId,
+		Payload:                  deployment.Payload,
+		Description:              deployment.Description,
+		CommitOid:                deployment.CommitOid,
+		Environment:              deployment.Environment,
+		State:                    deployment.State,
+		RepositoryID:             deployment.Repository.Id,
+		RepositoryName:           deployment.Repository.Name,
+		RepositoryUrl:            deployment.Repository.Url,
+		CreatedDate:              deployment.CreatedAt,
+		UpdatedDate:              deployment.UpdatedAt,
+		LatestStatusState:        deployment.LatestStatus.State,
+		LatestUpdatedDate:        deployment.LatestStatus.UpdatedAt,
+		LatestSuccessUpdatedDate: deployment.LatestStatus.UpdatedAt,
 	}
 	if deployment.Ref != nil {
 		ret.RefName = deployment.Ref.Name
 	}
+
+	// Find the first SUCCESS status and set LatestSuccessUpdatedDate
+	for _, status := range deployment.Statuses.Nodes {
+		if status.State == "SUCCESS" {
+			ret.LatestSuccessUpdatedDate = &status.UpdatedAt
+			break
+		}
+	}
+
 	return ret, nil
 }
diff --git a/caspeco.patch b/caspeco.patch
new file mode 100644
index 000000000..0fc98c95d
--- /dev/null
+++ b/caspeco.patch
@@ -0,0 +1,236 @@
+diff --git a/backend/plugins/github/models/deployment.go b/backend/plugins/github/models/deployment.go
+index 6a818be45..a41c08cf8 100644
+--- a/backend/plugins/github/models/deployment.go
++++ b/backend/plugins/github/models/deployment.go
+@@ -24,26 +24,27 @@ import (
+ )
+
+ type GithubDeployment struct {
+-	common.NoPKModel  `json:"-" mapstructure:"-"`
+-	ConnectionId      uint64 `json:"connection_id" gorm:"primaryKey"`
+-	GithubId          int    `json:"github_id"`
+-	Id                string `json:"id" gorm:"type:varchar(255);primaryKey"`
+-	DisplayTitle      string
+-	Url               string
+-	DatabaseId        uint       `json:"database_id"`
+-	CommitOid         string     `json:"commit_oid" gorm:"type:varchar(255)"`
+-	Description       string     `json:"description" gorm:"type:varchar(255)"`
+-	Environment       string     `json:"environment" gorm:"type:varchar(255)"`
+-	State             string     `json:"state" gorm:"type:varchar(255)"`
+-	LatestStatusState string     `json:"latest_status_state" gorm:"type:varchar(255)"`
+-	LatestUpdatedDate *time.Time `json:"latest_status_update_date"`
+-	RepositoryID      string     `json:"repository_id" gorm:"type:varchar(255)"`
+-	RepositoryName    string     `json:"repository_name" gorm:"type:varchar(255)"`
+-	RepositoryUrl     string     `json:"repository_url" gorm:"type:varchar(255)"`
+-	RefName           string     `json:"ref_name" gorm:"type:varchar(255)"`
+-	Payload           string     `json:"payload" gorm:"type:text"`
+-	CreatedDate       time.Time  `json:"created_at"`
+-	UpdatedDate       time.Time  `json:"updated_at"`
++	common.NoPKModel         `json:"-" mapstructure:"-"`
++	ConnectionId             uint64 `json:"connection_id" gorm:"primaryKey"`
++	GithubId                 int    `json:"github_id"`
++	Id                       string `json:"id" gorm:"type:varchar(255);primaryKey"`
++	DisplayTitle             string
++	Url                      string
++	DatabaseId               uint       `json:"database_id"`
++	CommitOid                string     `json:"commit_oid" gorm:"type:varchar(255)"`
++	Description              string     `json:"description" gorm:"type:varchar(255)"`
++	Environment              string     `json:"environment" gorm:"type:varchar(255)"`
++	State                    string     `json:"state" gorm:"type:varchar(255)"`
++	LatestStatusState        string     `json:"latest_status_state" gorm:"type:varchar(255)"`
++	LatestUpdatedDate        *time.Time `json:"latest_status_update_date"`
++	LatestSuccessUpdatedDate *time.Time `json:"latest_success_updated_date"`
++	RepositoryID             string     `json:"repository_id" gorm:"type:varchar(255)"`
++	RepositoryName           string     `json:"repository_name" gorm:"type:varchar(255)"`
++	RepositoryUrl            string     `json:"repository_url" gorm:"type:varchar(255)"`
++	RefName                  string     `json:"ref_name" gorm:"type:varchar(255)"`
++	Payload                  string     `json:"payload" gorm:"type:text"`
++	CreatedDate              time.Time  `json:"created_at"`
++	UpdatedDate              time.Time  `json:"updated_at"`
+ }
+
+ func (GithubDeployment) TableName() string {
+diff --git a/backend/plugins/github/models/migrationscripts/20251217_add_latest_status_update_date_to_deployment.go b/backend/plugins/github/models/migrationscripts/20251217_add_latest_status_update_date_to_deployment.go
+new file mode 100644
+index 000000000..334a3918d
+--- /dev/null
++++ b/backend/plugins/github/models/migrationscripts/20251217_add_latest_status_update_date_to_deployment.go
+@@ -0,0 +1,54 @@
++/*
++Licensed to the Apache Software Foundation (ASF) under one or more
++contributor license agreements.  See the NOTICE file distributed with
++this work for additional information regarding copyright ownership.
++The ASF licenses this file to You under the Apache License, Version 2.0
++(the "License"); you may not use this file except in compliance with
++the License.  You may obtain a copy of the License at
++
++    http://www.apache.org/licenses/LICENSE-2.0
++
++Unless required by applicable law or agreed to in writing, software
++distributed under the License is distributed on an "AS IS" BASIS,
++WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
++See the License for the specific language governing permissions and
++limitations under the License.
++*/
++
++package migrationscripts
++
++import (
++	"time"
++
++	"github.com/apache/incubator-devlake/core/context"
++	"github.com/apache/incubator-devlake/core/errors"
++	"github.com/apache/incubator-devlake/core/plugin"
++)
++
++var _ plugin.MigrationScript = (*addLatestStatusUpdateDateToDeployment)(nil)
++
++type deployment20251217 struct {
++	LatestSuccessUpdatedDate time.Time `json:"latest_success_updated_date"`
++}
++
++func (deployment20251217) TableName() string {
++	return "_tool_github_deployments"
++}
++
++type addLatestStatusUpdateDateToDeployment struct{}
++
++func (*addLatestStatusUpdateDateToDeployment) Up(basicRes context.BasicRes) errors.Error {
++	db := basicRes.GetDal()
++	if err := db.AutoMigrate(&deployment20251217{}); err != nil {
++		return err
++	}
++	return nil
++}
++
++func (*addLatestStatusUpdateDateToDeployment) Version() uint64 {
++	return 20251217000000
++}
++
++func (*addLatestStatusUpdateDateToDeployment) Name() string {
++	return "add latest_success_updated_date to _tool_github_deployments"
++}
+\ No newline at end of file
+diff --git a/backend/plugins/github/models/migrationscripts/register.go b/backend/plugins/github/models/migrationscripts/register.go
+index b8a0722eb..bf4635699 100644
+--- a/backend/plugins/github/models/migrationscripts/register.go
++++ b/backend/plugins/github/models/migrationscripts/register.go
+@@ -55,5 +55,6 @@ func All() []plugin.MigrationScript {
+ 		new(addIsDraftToPr),
+ 		new(changeIssueComponentType),
+ 		new(addIndexToGithubJobs),
++		new(addLatestStatusUpdateDateToDeployment),
+ 	}
+ }
+diff --git a/backend/plugins/github_graphql/tasks/deployment_collector.go b/backend/plugins/github_graphql/tasks/deployment_collector.go
+index b28c8deca..2477f1b71 100644
+--- a/backend/plugins/github_graphql/tasks/deployment_collector.go
++++ b/backend/plugins/github_graphql/tasks/deployment_collector.go
+@@ -91,6 +91,13 @@ type GraphqlQueryDeploymentDeployment struct {
+ 		} `graphql:"author"`
+ 		CommittedDate time.Time `graphql:"committedDate"`
+ 	} `graphql:"commit"`
++	Statuses struct {
++		Nodes []struct {
++			CreatedAt time.Time `graphql:"createdAt"`
++			UpdatedAt time.Time `graphql:"updatedAt"`
++			State     string    `graphql:"state"`
++		} `graphql:"nodes"`
++	} `graphql:"statuses(first: 10)"`
+ }
+
+ // CollectDeployments will request github api via graphql and store the result into raw layer.
+diff --git a/backend/plugins/github_graphql/tasks/deployment_convertor.go b/backend/plugins/github_graphql/tasks/deployment_convertor.go
+index fdc439553..ec07c2bb3 100644
+--- a/backend/plugins/github_graphql/tasks/deployment_convertor.go
++++ b/backend/plugins/github_graphql/tasks/deployment_convertor.go
+@@ -19,6 +19,7 @@ package tasks
+
+ import (
+ 	"reflect"
++	"regexp"
+
+ 	"github.com/apache/incubator-devlake/core/dal"
+ 	"github.com/apache/incubator-devlake/core/errors"
+@@ -90,7 +91,7 @@ func ConvertDeployment(taskCtx plugin.SubTaskContext) errors.Error {
+ 				TaskDatesInfo: devops.TaskDatesInfo{
+ 					CreatedDate:  githubDeployment.CreatedDate,
+ 					StartedDate:  &githubDeployment.CreatedDate,
+-					FinishedDate: &githubDeployment.UpdatedDate,
++					FinishedDate: githubDeployment.LatestSuccessUpdatedDate,
+ 				},
+ 				CommitSha:    githubDeployment.CommitOid,
+ 				RefName:      githubDeployment.RefName,
+@@ -103,8 +104,9 @@ func ConvertDeployment(taskCtx plugin.SubTaskContext) errors.Error {
+ 			durationSec := float64(githubDeployment.UpdatedDate.Sub(githubDeployment.CreatedDate).Milliseconds() / 1e3)
+ 			deploymentCommit.DurationSec = &durationSec
+
++			versionPattern := regexp.MustCompile(`^\d+\.\d+`)
+ 			if data.RegexEnricher != nil {
+-				if data.RegexEnricher.ReturnNameIfMatched(devops.ENV_NAME_PATTERN, githubDeployment.Environment) != "" {
++				if data.RegexEnricher.ReturnNameIfMatched(devops.ENV_NAME_PATTERN, githubDeployment.Environment) != "" && versionPattern.MatchString(githubDeployment.RefName) {
+ 					deploymentCommit.Environment = devops.PRODUCTION
+ 				}
+ 			}
+diff --git a/backend/plugins/github_graphql/tasks/deployment_extractor.go b/backend/plugins/github_graphql/tasks/deployment_extractor.go
+index 78a96ca76..6343451b5 100644
+--- a/backend/plugins/github_graphql/tasks/deployment_extractor.go
++++ b/backend/plugins/github_graphql/tasks/deployment_extractor.go
+@@ -75,28 +75,38 @@ func ExtractDeployments(taskCtx plugin.SubTaskContext) errors.Error {
+
+ func convertGithubDeployment(deployment *GraphqlQueryDeploymentDeployment, connectionId uint64, githubId int) (*githubModels.GithubDeployment, errors.Error) {
+ 	ret := &githubModels.GithubDeployment{
+-		ConnectionId:      connectionId,
+-		GithubId:          githubId,
+-		NoPKModel:         common.NewNoPKModel(),
+-		Id:                deployment.Id,
+-		DisplayTitle:      strings.Split(deployment.Commit.Message, "\n")[0],
+-		Url:               deployment.Repository.Url + "/deployments/" + deployment.Environment,
+-		DatabaseId:        deployment.DatabaseId,
+-		Payload:           deployment.Payload,
+-		Description:       deployment.Description,
+-		CommitOid:         deployment.CommitOid,
+-		Environment:       deployment.Environment,
+-		State:             deployment.State,
+-		RepositoryID:      deployment.Repository.Id,
+-		RepositoryName:    deployment.Repository.Name,
+-		RepositoryUrl:     deployment.Repository.Url,
+-		CreatedDate:       deployment.CreatedAt,
+-		UpdatedDate:       deployment.UpdatedAt,
+-		LatestStatusState: deployment.LatestStatus.State,
+-		LatestUpdatedDate: deployment.LatestStatus.UpdatedAt,
++		ConnectionId:             connectionId,
++		GithubId:                 githubId,
++		NoPKModel:                common.NewNoPKModel(),
++		Id:                       deployment.Id,
++		DisplayTitle:             strings.Split(deployment.Commit.Message, "\n")[0],
++		Url:                      deployment.Repository.Url + "/deployments/" + deployment.Environment,
++		DatabaseId:               deployment.DatabaseId,
++		Payload:                  deployment.Payload,
++		Description:              deployment.Description,
++		CommitOid:                deployment.CommitOid,
++		Environment:              deployment.Environment,
++		State:                    deployment.State,
++		RepositoryID:             deployment.Repository.Id,
++		RepositoryName:           deployment.Repository.Name,
++		RepositoryUrl:            deployment.Repository.Url,
++		CreatedDate:              deployment.CreatedAt,
++		UpdatedDate:              deployment.UpdatedAt,
++		LatestStatusState:        deployment.LatestStatus.State,
++		LatestUpdatedDate:        deployment.LatestStatus.UpdatedAt,
++		LatestSuccessUpdatedDate: deployment.LatestStatus.UpdatedAt,
+ 	}
+ 	if deployment.Ref != nil {
+ 		ret.RefName = deployment.Ref.Name
+ 	}
++
++	// Find the first SUCCESS status and set LatestSuccessUpdatedDate
++	for _, status := range deployment.Statuses.Nodes {
++		if status.State == "SUCCESS" {
++			ret.LatestSuccessUpdatedDate = &status.UpdatedAt
++			break
++		}
++	}
++
+ 	return ret, nil
+ }
-- 
2.52.0

